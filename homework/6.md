---
sidebar_position: 6
homework_number: 6
hide_table_of_contents: true
title: Homework 6 -- Lists (Iteration)
---


**Skills Practiced: [3](/skills/#(3))**

---

Idea: extracting columns from a table, doing custom calculations over them.

## Introduction
You're working as a data analyst for an online bookstore. The company has provided you with a sales table containing information about book orders. Your job is to extract columns from this table and perform various calculations to help the business understand their sales patterns.
Assume you have access to a table called `book-sales` with the following columns:

```pyret
"title" (String): The book title
"price" (Number): Price per book in dollars
"quantity" (Number): Number of copies sold
"category" (String): Book category (e.g., "Fiction", "Science", "History")
"customer-email" (String): Customer's email address
"discount-code" (String): Discount code used ("none" if no discount)
```

## Problem 1
Design a function `total-revenue` that takes a book sales table and calculates the total revenue (price Ã— quantity for all orders combined).

## Problem 2
Design a function `average-order-value` that takes a book sales table and returns the average revenue per order (not per book).

## Problem 3
Design a function `high-value-customers` that takes a book sales table and a threshold amount, and returns a list of unique customer email addresses for customers whose total purchases exceed the threshold. (elaine note: might change this cuz i realized my solution requires `distinct`)

## Problem 4 (Interpretive?)
The bookstore is considering sharing customer purchase data with publishers for marketing analysis. The proposed data format would include customer email addresses alongside their purchase histories.
Identify at least 2 privacy concerns with sharing detailed customer purchase data, and suggest a technical approach the bookstore could use to provide useful analytics to publishers while better protecting customer privacy. Respond in at most 3 sentences.

## Problem 5
Design a function `customer-book-count` that takes a book sales table and a customer email address, and returns the total number of books (sum of quantities) that the customer has purchased.



